{% extends "clients/dashboard2.html" %}

{% block styles %}
    {% comment %} <link rel="stylesheet" href="{% static 'path/to/styles.css' %}"> {% endcomment %}
{% endblock %}

{% block content %}
    <!-- <div class="container mt-5">

</div> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/boxicons/2.1.0/css/boxicons.min.css" integrity="sha512-pVCM5+SN2+qwj36KonHToF2p1oIvoU3bsqxphdOIWMYmgr4ZqD3t5DjKvvetKhXGc/ZG5REYTT6ltKfExEei/Q==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/5.3.45/css/materialdesignicons.css" integrity="sha256-NAxhqDvtY0l4xn+YVa6WjAcmd94NNfttjNsDmNatFVc=" crossorigin="anonymous" />

<div class="container">
    <div class="row align-items-center">
        <div class="col-md-6">
            <div class="mb-3">
                <h5 class="card-title">Ticket List <span class="text-muted fw-normal ms-2">({{ticket_count}})</span></h5>
            </div>
        </div>
        <div class="col-md-6">
            <div class="d-flex flex-wrap align-items-center justify-content-end gap-2 mb-3">
                
                <div>
                    <a href="{% url "add_ticket" %}" data-bs-toggle="modal" data-bs-target=".add-new" class="btn btn-primary"><i class="bx bx-plus me-1"></i> Ajouter un nouveau</a>
                </div>
                {% comment %} <div class="dropdown">
                    <a class="btn btn-link text-muted py-1 font-size-16 shadow-none dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"></a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#">Action</a></li>
                        <li><a class="dropdown-item" href="#">Another action</a></li>
                        <li><a class="dropdown-item" href="#">Something else here</a></li>
                    </ul>
                </div> {% endcomment %}
            </div>
        </div>
    </div>
     <div class="row">
      {% for ticket in tickets %}
        <div class="col-xl-3 col-sm-6">
            <div class="card">
                <div class="card-body">
                    {% comment %} <div class="dropdown float-end">
                        <a class="text-muted dropdown-toggle font-size-16" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true"><i class="bx bx-dots-horizontal-rounded"></i></a>
                        <div class="dropdown-menu dropdown-menu-end"><a class="dropdown-item" href="#">Edit</a><a class="dropdown-item" href="#">Action</a><a class="dropdown-item" href="#">Remove</a></div>
                    </div> {% endcomment %}
                    <div class="d-flex align-items-center">
                        {% comment %} <div><img src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="" class="avatar-md rounded-circle img-thumbnail" /></div> {% endcomment %}
                        <div class="flex-1 ms-3">
                            <h5 class="font-size-16 mb-1"><a href="#" class="text-dark">{{ticket.typeTicket}}</a></h5>
                            {% if ticket.status == 'Ouvert' %}
                            <span class="badge badge-success mb-0">{{ ticket.status }}</span>
                            {% elif ticket.status == 'En Cours de traitement' %}
                                <span class="badge badge-warning mb-0">{{ ticket.status }}</span>
                            {% elif ticket.status == 'Ferm√©e' %}
                                <span class="badge badge-danger mb-0">{{ ticket.status }}</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="mt-3 pt-1">
                      <p class="text-muted mb-0"><i class="mdi mdi-clock font-size-15 align-middle pe-2 text-primary"></i> {{ticket.date_created}}</p>
                      <p class="text-muted mb-0 mt-2"><i class="mdi mdi-email font-size-15 align-middle pe-2 text-primary"></i> Lorem ipsum dolor sit amet consectetur adipisicing elit. Suscipit vel harum, eos, eligendi earum fuga ut.</p>
                        {% comment %} <p class="text-muted mb-0 mt-2"><i class="mdi mdi-google-maps font-size-15 align-middle pe-2 text-primary"></i> 52 Ilchester MYBSTER 9WX</p> {% endcomment %}
                    </div>
                    <div class="d-flex gap-2 pt-4">
                        {% comment %} <button type="button" class="btn btn-soft-primary btn-sm w-50"><i class="bx bx-user me-1"></i> Profile</button> {% endcomment %}
                        <button type="button" class="btn btn-primary btn-sm w-50"><i class="mdi mdi-receipt me-1"></i>Plus d'information</button>
                    </div>
                  </div>
            </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% comment %} <div class="row g-0 align-items-center pb-4">
        <div class="col-sm-6">
            <div><p class="mb-sm-0">Showing 1 to 10 of 57 entries</p></div>
        </div>
        <div class="col-sm-6">
            <div class="float-sm-end">
                <ul class="pagination mb-sm-0">
                    <li class="page-item disabled">
                        <a href="#" class="page-link"><i class="mdi mdi-chevron-left"></i></a>
                    </li>
                    <li class="page-item active"><a href="#" class="page-link">1</a></li>
                    <li class="page-item"><a href="#" class="page-link">2</a></li>
                    <li class="page-item"><a href="#" class="page-link">3</a></li>
                    <li class="page-item"><a href="#" class="page-link">4</a></li>
                    <li class="page-item"><a href="#" class="page-link">5</a></li>
                    <li class="page-item">
                        <a href="#" class="page-link"><i class="mdi mdi-chevron-right"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div> {% endcomment %}

<style>
  body{
    margin-top:20px;
    {% comment %} background-color:#eee; {% endcomment %}
    }
    .card {
        margin-bottom: 24px;
        box-shadow: 0 2px 3px #e4e8f0;
    }
    .card {
        position: relative;
        display: flex;
        flex-direction: column;
        min-width: 0;
        word-wrap: break-word;
        background-color: #fff;
        background-clip: border-box;
        border: 1px solid #eff0f2;
        border-radius: 1rem;
    }
    .avatar-md {
        height: 4rem;
        width: 4rem;
    }
    .rounded-circle {
        border-radius: 50%!important;
    }
    .img-thumbnail {
        padding: 0.25rem;
        background-color: #f1f3f7;
        border: 1px solid #eff0f2;
        border-radius: 0.75rem;
    }
    .avatar-title {
        align-items: center;
        background-color: #3b76e1;
        color: #fff;
        display: flex;
        font-weight: 500;
        height: 100%;
        justify-content: center;
        width: 100%;
    }
    .bg-soft-primary {
        background-color: rgba(59,118,225,.25)!important;
    }
    a {
        text-decoration: none!important;
    }
    .badge-soft-danger {
        color: #f56e6e !important;
        background-color: rgba(245,110,110,.1);
    }
    .badge-soft-success {
        color: #63ad6f !important;
        background-color: rgba(99,173,111,.1);
    }
    .mb-0 {
        margin-bottom: 0!important;
    }
    .badge {
        display: inline-block;
        padding: 0.25em 0.6em;
        font-size: 75%;
        font-weight: 500;
        line-height: 1;
        color: #fff;
        text-align: center;
        white-space: nowrap;
        vertical-align: baseline;
        border-radius: 0.75rem;
    }

</style>


{% comment %} <div class="container-fluid p-5" style="background-color:#F2F3F4;">
  <div class=" row">
    <div class="col-lg-8 offset-lg-2">
      <div class="shadow-sm wrapper p-4" style="background-color:#ffffff;">
        <h3 class="h5 mb-4 fw-bold border-bottom pb-2">Create Ticket</h3>
        <form method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="row g-3 mb-3">
            <div class="col">
              <label for="status" class="form-label">Drop 1 <span class="text-danger">*</span></label>
              <select id="status" class="form-control" name="status" required>
                <option value="">Choose Status</option>
                <option value="Open">Open</option>
                <option value="In Progress">In Progress</option>
                <option value="Closed">Closed</option>
              </select>
            </div>
            <!-- /.col -->
            <div class="col">
              <label for="priority" class="form-label">Drop 2 <span class="text-danger">*</span></label>
              <select id="priority" class="form-control" name="priority" required>
                <option value="">Choose Priority</option>
                  <option value="Customer Relation">Customer Relation</option>
                  <option value="Accounts">Accounts</option>
                  <option value="NOC Support">NOC Support</option>
                </select>
              </select>
            </div>
            <!-- /.col -->
          </div>
          <!-- /.row -->
          <div class="mb-3">
            <label for="code" class="form-label">Code of Ticket <span class="text-danger">*</span></label>
            <input type="text" id="code" class="form-control" name="code" required>
          </div>
          <!-- /.mb-3 -->
          <div class="mb-3">
            <label for="message" class="form-label">Message <span class="text-danger">*</span></label>
            <textarea id="message" class="form-control" name="message" rows="4" required></textarea>
          </div>
          <!-- /.mb-3 -->
          <div class="mb-3">
            <label for="attachment" class="form-label">Attach File(s)</label>
            <input type="file" class="d-block" id="attachment" name="attachment" accept=".csv,image/jpeg,image/jpg,image/png,image/bmp,image/gif,application/pdf,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" multiple>
            <small id="attachment-guide" class="form-text">Only JPEG, JPG, PNG, BMP, GIF, PDF, CSV, XLS, and XLSX formats are allowed.</small>
          </div>
          <!-- /.mb-3 -->
          <div class="response-message"></div>
          <div class="border-top pt-3 clearfix">
            <button type="submit" class="btn btn-primary float-end">Submit</button>
          </div>
        </form>
      </div>
      <!-- /.wrapper -->
    </div>
    <!-- /col -->
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
const statusSelect = document.getElementById('status');
const prioritySelect = document.getElementById('priority');

const priorityOptions = {
  'Open': ['Low', 'High'],
  'In Progress': ['Medium', 'High'],
  'Closed': ['Low', 'Medium']
};

function updatePriorityOptions() {
  const selectedStatus = statusSelect.value;
  const options = priorityOptions[selectedStatus] || [];

  prioritySelect.innerHTML = '';
  options.forEach(option => {
    const optionElement = document.createElement('option');
    optionElement.value = option;
    optionElement.textContent = option;
    prioritySelect.appendChild(optionElement);
  });
}

statusSelect.addEventListener('change', updatePriorityOptions);
updatePriorityOptions();  // Initial call to set up the options
});
</script> {% endcomment %}
{% endblock %}
